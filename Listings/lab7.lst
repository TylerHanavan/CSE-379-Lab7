


ARM Macro Assembler    Page 1 


    1 00000000                 PRESERVE8
    2 00000000                 AREA             interrupts, CODE, READWRITE
    3 00000000         
    4 00000000                 EXPORT           lab7
    5 00000000         
    6 00000000                 EXPORT           FIQ_Handler
    7 00000000         
    8 00000000                 EXTERN           uart_init
    9 00000000                 EXTERN           pin_connect_block_setup_for_uar
t0
   10 00000000                 EXTERN           setup_pins
   11 00000000                 EXTERN           validate_input
   12 00000000                 EXTERN           change_display
   13 00000000                 EXTERN           clear_display
   14 00000000                 EXTERN           toggle_seven_seg
   15 00000000                 EXTERN           read_character
   16 00000000                 EXTERN           output_character
   17 00000000                 EXTERN           output_string
   18 00000000                 EXTERN           new_line
   19 00000000         
   20 00000000                 EXTERN           change_display_digit
   21 00000000                 EXTERN           get_digit
   22 00000000         
   23 00000000                 EXTERN           from_ascii
   24 00000000         
   25 00000000                 EXTERN           store_input
   26 00000000                 EXTERN           get_input
   27 00000000                 EXTERN           clear_input
   28 00000000         
   29 00000000                 EXTERN           is_enemy_alive
   30 00000000                 EXTERN           do_tick
   31 00000000                 EXTERN           handle_input
   32 00000000         
   33 00000000 2F 2F 2F 
              2F 00    enemies =                "////",0
   34 00000005 2F 2F 2F 
              2F 00    shields_alive
                               =                "////",0
   35 0000000A 2F 2F 2F 
              2F 00    shields_type
                               =                "////",0
   36 0000000F 00              ALIGN
   37 00000010         
   38 00000010         lab7
   39 00000010         
   40 00000010 E92D4000        STMFD            sp!, {lr}
   41 00000014         
   42 00000014 EBFFFFFE        BL               uart_init   ;setup the uart wit
                                                            h its init subrouti
                                                            ne
   43 00000018 EBFFFFFE        BL               pin_connect_block_setup_for_uar
t0 
                                                            ;setup the pin conn
                                                            ect block
   44 0000001C EBFFFFFE        BL               setup_pins  ;setup pins require
                                                            d for momentary pus
                                                            h button and seven 
                                                            segment display 
   45 00000020 EB000008        BL               interrupt_init



ARM Macro Assembler    Page 2 


   46 00000024 EBFFFFFE        BL               clear_display
   47 00000028         
   48 00000028 E59F4190        LDR              r4, =enemies
   49 0000002C EBFFFFFE        BL               output_string
   50 00000030         
   51 00000030 E3A09000        MOV              r9, #0
   52 00000034         
   53 00000034 E3A08002        MOV              r8, #2
   54 00000038         
   55 00000038         lab7_loop
   56 00000038         
   57 00000038         ;CMP r7, #5
   58 00000038         ;BGE lab7_end
   59 00000038         
   60 00000038 EAFFFFFE        B                lab7_loop
   61 0000003C         
   62 0000003C         lab7_end
   63 0000003C         
   64 0000003C EBFFFFFE        BL               clear_display
   65 00000040         
   66 00000040 E8BD4000        LDMFD            sp!,{lr}
   67 00000044         
   68 00000044 E12FFF1E        BX               lr
   69 00000048         
   70 00000048         
   71 00000048         
   72 00000048         interrupt_init
   73 00000048         
   74 00000048 E92D4007        STMFD            SP!, {r0-r2, lr} 
                                                            ; Save registers 
   75 0000004C         
   76 0000004C         ; Push button setup   
   77 0000004C         
   78 0000004C E59F0170        LDR              r0, =0xE002C000
   79 00000050         
   80 00000050 E5901000        LDR              r1, [r0]
   81 00000054         
   82 00000054 E3811202        ORR              r1, r1, #0x20000000
   83 00000058         
   84 00000058 E3C11201        BIC              r1, r1, #0x10000000
   85 0000005C         
   86 0000005C E5801000        STR              r1, [r0]    ; PINSEL0 bits 29:2
                                                            8 = 10
   87 00000060         
   88 00000060         
   89 00000060         ;key board setup
   90 00000060 E59F0160        LDR              r0, =0xE000C004
   91 00000064         
   92 00000064 E5901000        LDR              r1, [r0]
   93 00000068         
   94 00000068 E3811001        ORR              r1, r1, #0x1
   95 0000006C         
   96 0000006C E5801000        STR              r1, [r0]
   97 00000070         
   98 00000070         
   99 00000070         ; Classify sources as IRQ or FIQ
  100 00000070         
  101 00000070 E59F0154        LDR              r0, =0xFFFFF000
  102 00000074         



ARM Macro Assembler    Page 3 


  103 00000074 E590100C        LDR              r1, [r0, #0xC]
  104 00000078         
  105 00000078 E59F2150        LDR              r2, =0x8050
  106 0000007C         
  107 0000007C E1811002        ORR              r1, r1, r2  ; External Interrup
                                                            t 1
  108 00000080         
  109 00000080 E580100C        STR              r1, [r0, #0xC]
  110 00000084         
  111 00000084         
  112 00000084         
  113 00000084         ; Enable Interrupts
  114 00000084         
  115 00000084 E59F0140        LDR              r0, =0xFFFFF000
  116 00000088         
  117 00000088 E5901010        LDR              r1, [r0, #0x10]
  118 0000008C         
  119 0000008C E59F213C        LDR              r2, =0x8050
  120 00000090         
  121 00000090 E1811002        ORR              r1, r1, r2  ; External Interrup
                                                            t 1
  122 00000094         
  123 00000094 E5801010        STR              r1, [r0, #0x10]
  124 00000098         
  125 00000098         
  126 00000098         
  127 00000098         ; External Interrupt 1 setup for edge sensitive
  128 00000098         
  129 00000098 E59F0134        LDR              r0, =0xE01FC148
  130 0000009C         
  131 0000009C E5901000        LDR              r1, [r0]
  132 000000A0         
  133 000000A0 E3811002        ORR              r1, r1, #2  ; EINT1 = Edge Sens
                                                            itive
  134 000000A4         
  135 000000A4 E5801000        STR              r1, [r0]
  136 000000A8         
  137 000000A8         ; External Timer 0 modify MR0
  138 000000A8         
  139 000000A8 E59F0128        LDR              r0, =0xE0004018
  140 000000AC         
  141 000000AC E59F1128        LDR              r1, =110000
  142 000000B0         
  143 000000B0 E5801000        STR              r1, [r0]
  144 000000B4         
  145 000000B4         
  146 000000B4         ; External Timer 0 MCR
  147 000000B4         
  148 000000B4 E59F0124        LDR              r0, =0xE0004014
  149 000000B8         
  150 000000B8 E5901000        LDR              r1, [r0]
  151 000000BC         
  152 000000BC         ;ORR r1, r1, #3
  153 000000BC         ;ORR r1, r1, #8
  154 000000BC E3811003        ORR              r1, r1, #0x3
  155 000000C0 E3C11020        BIC              r1, r1, #0x20
  156 000000C4         
  157 000000C4 E5801000        STR              r1, [r0]
  158 000000C8         



ARM Macro Assembler    Page 4 


  159 000000C8         ; External Timer 0 timer control register
  160 000000C8         
  161 000000C8 E59F0114        LDR              r0, =0xE0004004
  162 000000CC         
  163 000000CC E5901000        LDR              r1, [r0]
  164 000000D0         
  165 000000D0 E3811001        ORR              r1, r1, #1
  166 000000D4         
  167 000000D4 E5801000        STR              r1, [r0]
  168 000000D8         
  169 000000D8         ; Enable FIQ's, Disable IRQ's
  170 000000D8         
  171 000000D8 E10F0000        MRS              r0, CPSR
  172 000000DC         
  173 000000DC E3C00040        BIC              r0, r0, #0x40
  174 000000E0         
  175 000000E0 E3800080        ORR              r0, r0, #0x80
  176 000000E4         
  177 000000E4 E121F000        MSR              CPSR_c, r0
  178 000000E8         
  179 000000E8         
  180 000000E8         
  181 000000E8 E8BD4007        LDMFD            SP!, {r0-r2, lr} 
                                                            ; Restore registers
                                                            
  182 000000EC         
  183 000000EC E12FFF1E        BX               lr          ; Return
  184 000000F0         
  185 000000F0         FIQ_Handler
  186 000000F0         
  187 000000F0 E92D401F        STMFD            SP!, {r0, r1, r2, r3, r4, lr} 
                                                            ; Save registers
  188 000000F4         
  189 000000F4         ; Disable Interrupts
  190 000000F4         
  191 000000F4 E59F00D0        LDR              r0, =0xFFFFF000
  192 000000F8         
  193 000000F8 E5901010        LDR              r1, [r0, #0x10]
  194 000000FC         
  195 000000FC E3A02010        MOV              r2, #0x10
  196 00000100         
  197 00000100 E1C11002        BIC              r1, r1, r2  ; External Interrup
                                                            t 1
  198 00000104         
  199 00000104 E5801010        STR              r1, [r0, #0x10]
  200 00000108         
  201 00000108 E59F00D8        LDR              r0, =0xE0004000
  202 0000010C E5901000        LDR              r1, [r0]
  203 00000110 E3510000        CMP              r1, #0
  204 00000114 CA000000        BGT              TIMER0
  205 00000118 EA00000C        B                EINT1
  206 0000011C         
  207 0000011C         TIMER0
  208 0000011C         
  209 0000011C E3811001        ORR              r1, r1, #1
  210 00000120 E5801000        STR              r1, [r0]
  211 00000124         
  212 00000124         TIMER0LOOP
  213 00000124         



ARM Macro Assembler    Page 5 


  214 00000124 E59F20C0        LDR              r2, =do_tick
  215 00000128 E1A0E00F        MOV              lr, pc
  216 0000012C E12FFF12        BX               r2
  217 00000130         
  218 00000130 EA000017        B                FIQ_Exit
  219 00000134         
  220 00000134         R0_RESET
  221 00000134 E92D4000        STMFD            SP!, {lr}
  222 00000138 E3A00000        MOV              r0, #0x0
  223 0000013C E2811001        ADD              r1, #0x1
  224 00000140 EBFFFFFE        BL               new_line
  225 00000144 E8BD4000        LDMFD            SP!, {lr}
  226 00000148 E12FFF1E        BX               lr
  227 0000014C         
  228 0000014C EA000010        B                FIQ_Exit
  229 00000150         
  230 00000150         EINT1                                ; Check for EINT1 i
                                                            nterrupt
  231 00000150         
  232 00000150         
  233 00000150 E59F0098        LDR              r0, =0xE01FC140
  234 00000154         
  235 00000154 E5901000        LDR              r1, [r0]
  236 00000158         
  237 00000158 E3110002        TST              r1, #2
  238 0000015C         
  239 0000015C 0A000003        BEQ              FIQ_Keys
  240 00000160         
  241 00000160 EBFFFFFE        BL               toggle_seven_seg
  242 00000164         
  243 00000164 E3811002        ORR              r1, r1, #2  ; Clear Interrupt
  244 00000168         
  245 00000168 E5801000        STR              r1, [r0]
  246 0000016C         
  247 0000016C EA000008        B                FIQ_Exit
  248 00000170         
  249 00000170         FIQ_Keys
  250 00000170         
  251 00000170 E59F007C        LDR              r0, =0xE000C008
  252 00000174         
  253 00000174 E5901000        LDR              r1, [r0]
  254 00000178         
  255 00000178 E2012001        AND              r2, r1, #1
  256 0000017C         
  257 0000017C E3520000        CMP              r2, #0
  258 00000180         
  259 00000180 1A000003        BNE              FIQ_Exit
  260 00000184         
  261 00000184 EBFFFFFE        BL               read_character
  262 00000188         
  263 00000188 E59F2068        LDR              r2, =handle_input
  264 0000018C E1A0E00F        MOV              lr, pc
  265 00000190 E12FFF12        BX               r2
  266 00000194         
  267 00000194         quit_skip
  268 00000194         
  269 00000194         FIQ_Exit
  270 00000194         
  271 00000194         



ARM Macro Assembler    Page 6 


  272 00000194         ; Enable Interrupts
  273 00000194         
  274 00000194 E59F0030        LDR              r0, =0xFFFFF000
  275 00000198         
  276 00000198 E5901010        LDR              r1, [r0, #0x10]
  277 0000019C         
  278 0000019C E59F202C        LDR              r2, =0x8050
  279 000001A0         
  280 000001A0 E1811002        ORR              r1, r1, r2  ; External Interrup
                                                            t 1
  281 000001A4         
  282 000001A4 E5801010        STR              r1, [r0, #0x10]
  283 000001A8         
  284 000001A8         
  285 000001A8         
  286 000001A8 E59F0038        LDR              r0, =0xE0004000
  287 000001AC E5901000        LDR              r1, [r0]
  288 000001B0         
  289 000001B0 E3C11001        BIC              r1, r1, #1
  290 000001B4 E5801000        STR              r1, [r0]
  291 000001B8         
  292 000001B8 E8BD401F        LDMFD            SP!, {r0, r1, r2, r3, r4, lr}
  293 000001BC         
  294 000001BC E25EF004        SUBS             pc, lr, #4
  295 000001C0         
  296 000001C0         
  297 000001C0         
  298 000001C0                 END
              00000000 
              E002C000 
              E000C004 
              FFFFF000 
              00008050 
              E01FC148 
              E0004018 
              0001ADB0 
              E0004014 
              E0004004 
              E0004000 
              00000000 
              E01FC140 
              E000C008 
              00000000 
Command Line: --debug --xref --diag_suppress=9931 --apcs=interwork --depend=.\o
bjects\lab7.d -o.\objects\lab7.o -IC:\Keil_v5\ARM\RV31\INC -IC:\Keil_v5\ARM\CMS
IS\Include -IC:\Keil_v5\ARM\INC\Philips --predefine="__EVAL SETA 1" --predefine
="__UVISION_VERSION SETA 524" --list=.\listings\lab7.lst lab7.s



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

EINT1 00000150

Symbol: EINT1
   Definitions
      At line 230 in file lab7.s
   Uses
      At line 205 in file lab7.s
Comment: EINT1 used once
FIQ_Exit 00000194

Symbol: FIQ_Exit
   Definitions
      At line 269 in file lab7.s
   Uses
      At line 218 in file lab7.s
      At line 228 in file lab7.s
      At line 247 in file lab7.s
      At line 259 in file lab7.s

FIQ_Handler 000000F0

Symbol: FIQ_Handler
   Definitions
      At line 185 in file lab7.s
   Uses
      At line 6 in file lab7.s
Comment: FIQ_Handler used once
FIQ_Keys 00000170

Symbol: FIQ_Keys
   Definitions
      At line 249 in file lab7.s
   Uses
      At line 239 in file lab7.s
Comment: FIQ_Keys used once
R0_RESET 00000134

Symbol: R0_RESET
   Definitions
      At line 220 in file lab7.s
   Uses
      None
Comment: R0_RESET unused
TIMER0 0000011C

Symbol: TIMER0
   Definitions
      At line 207 in file lab7.s
   Uses
      At line 204 in file lab7.s
Comment: TIMER0 used once
TIMER0LOOP 00000124

Symbol: TIMER0LOOP
   Definitions
      At line 212 in file lab7.s
   Uses
      None
Comment: TIMER0LOOP unused



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

enemies 00000000

Symbol: enemies
   Definitions
      At line 33 in file lab7.s
   Uses
      At line 48 in file lab7.s
Comment: enemies used once
interrupt_init 00000048

Symbol: interrupt_init
   Definitions
      At line 72 in file lab7.s
   Uses
      At line 45 in file lab7.s
Comment: interrupt_init used once
interrupts 00000000

Symbol: interrupts
   Definitions
      At line 2 in file lab7.s
   Uses
      None
Comment: interrupts unused
lab7 00000010

Symbol: lab7
   Definitions
      At line 38 in file lab7.s
   Uses
      At line 4 in file lab7.s
Comment: lab7 used once
lab7_end 0000003C

Symbol: lab7_end
   Definitions
      At line 62 in file lab7.s
   Uses
      None
Comment: lab7_end unused
lab7_loop 00000038

Symbol: lab7_loop
   Definitions
      At line 55 in file lab7.s
   Uses
      At line 60 in file lab7.s
Comment: lab7_loop used once
quit_skip 00000194

Symbol: quit_skip
   Definitions
      At line 267 in file lab7.s
   Uses
      None
Comment: quit_skip unused
shields_alive 00000005

Symbol: shields_alive



ARM Macro Assembler    Page 3 Alphabetic symbol ordering
Relocatable symbols

   Definitions
      At line 34 in file lab7.s
   Uses
      None
Comment: shields_alive unused
shields_type 0000000A

Symbol: shields_type
   Definitions
      At line 35 in file lab7.s
   Uses
      None
Comment: shields_type unused
16 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
External symbols

change_display 00000000

Symbol: change_display
   Definitions
      At line 12 in file lab7.s
   Uses
      None
Comment: change_display unused
change_display_digit 00000000

Symbol: change_display_digit
   Definitions
      At line 20 in file lab7.s
   Uses
      None
Comment: change_display_digit unused
clear_display 00000000

Symbol: clear_display
   Definitions
      At line 13 in file lab7.s
   Uses
      At line 46 in file lab7.s
      At line 64 in file lab7.s

clear_input 00000000

Symbol: clear_input
   Definitions
      At line 27 in file lab7.s
   Uses
      None
Comment: clear_input unused
do_tick 00000000

Symbol: do_tick
   Definitions
      At line 30 in file lab7.s
   Uses
      At line 214 in file lab7.s
Comment: do_tick used once
from_ascii 00000000

Symbol: from_ascii
   Definitions
      At line 23 in file lab7.s
   Uses
      None
Comment: from_ascii unused
get_digit 00000000

Symbol: get_digit
   Definitions
      At line 21 in file lab7.s
   Uses
      None
Comment: get_digit unused
get_input 00000000




ARM Macro Assembler    Page 2 Alphabetic symbol ordering
External symbols

Symbol: get_input
   Definitions
      At line 26 in file lab7.s
   Uses
      None
Comment: get_input unused
handle_input 00000000

Symbol: handle_input
   Definitions
      At line 31 in file lab7.s
   Uses
      At line 263 in file lab7.s
Comment: handle_input used once
is_enemy_alive 00000000

Symbol: is_enemy_alive
   Definitions
      At line 29 in file lab7.s
   Uses
      None
Comment: is_enemy_alive unused
new_line 00000000

Symbol: new_line
   Definitions
      At line 18 in file lab7.s
   Uses
      At line 224 in file lab7.s
Comment: new_line used once
output_character 00000000

Symbol: output_character
   Definitions
      At line 16 in file lab7.s
   Uses
      None
Comment: output_character unused
output_string 00000000

Symbol: output_string
   Definitions
      At line 17 in file lab7.s
   Uses
      At line 49 in file lab7.s
Comment: output_string used once
pin_connect_block_setup_for_uart0 00000000

Symbol: pin_connect_block_setup_for_uart0
   Definitions
      At line 9 in file lab7.s
   Uses
      At line 43 in file lab7.s
Comment: pin_connect_block_setup_for_uart0 used once
read_character 00000000

Symbol: read_character
   Definitions
      At line 15 in file lab7.s



ARM Macro Assembler    Page 3 Alphabetic symbol ordering
External symbols

   Uses
      At line 261 in file lab7.s
Comment: read_character used once
setup_pins 00000000

Symbol: setup_pins
   Definitions
      At line 10 in file lab7.s
   Uses
      At line 44 in file lab7.s
Comment: setup_pins used once
store_input 00000000

Symbol: store_input
   Definitions
      At line 25 in file lab7.s
   Uses
      None
Comment: store_input unused
toggle_seven_seg 00000000

Symbol: toggle_seven_seg
   Definitions
      At line 14 in file lab7.s
   Uses
      At line 241 in file lab7.s
Comment: toggle_seven_seg used once
uart_init 00000000

Symbol: uart_init
   Definitions
      At line 8 in file lab7.s
   Uses
      At line 42 in file lab7.s
Comment: uart_init used once
validate_input 00000000

Symbol: validate_input
   Definitions
      At line 11 in file lab7.s
   Uses
      None
Comment: validate_input unused
20 symbols
370 symbols in table
