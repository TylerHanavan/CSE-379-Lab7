


ARM Macro Assembler    Page 1 


    1 00000000                 PRESERVE8
    2 00000000                 AREA             interrupts, CODE, READWRITE
    3 00000000         
    4 00000000                 EXPORT           lab7
    5 00000000         
    6 00000000                 EXPORT           FIQ_Handler
    7 00000000         
    8 00000000                 EXTERN           uart_init
    9 00000000                 EXTERN           pin_connect_block_setup_for_uar
t0
   10 00000000                 EXTERN           setup_pins
   11 00000000                 EXTERN           validate_input
   12 00000000                 EXTERN           change_display
   13 00000000                 EXTERN           clear_display
   14 00000000                 EXTERN           toggle_seven_seg
   15 00000000                 EXTERN           read_character
   16 00000000                 EXTERN           output_character
   17 00000000                 EXTERN           output_string
   18 00000000                 EXTERN           new_line
   19 00000000         
   20 00000000                 EXTERN           change_display_digit
   21 00000000                 EXTERN           get_digit
   22 00000000         
   23 00000000                 EXTERN           from_ascii
   24 00000000         
   25 00000000                 EXTERN           store_input
   26 00000000                 EXTERN           get_input
   27 00000000                 EXTERN           clear_input
   28 00000000         
   29 00000000                 EXTERN           get_char_at
   30 00000000                 EXTERN           draw_board
   31 00000000                 EXTERN           is_enemy_alive
   32 00000000         
   33 00000000 2F 2F 2F 
              2F 00    enemies =                "////",0
   34 00000005 2F 2F 2F 
              2F 00    shields_alive
                               =                "////",0
   35 0000000A 2F 2F 2F 
              2F 00    shields_type
                               =                "////",0
   36 0000000F 00              ALIGN
   37 00000010         
   38 00000010         lab7
   39 00000010         
   40 00000010 E92D4000        STMFD            sp!, {lr}
   41 00000014         
   42 00000014 EBFFFFFE        BL               uart_init   ;setup the uart wit
                                                            h its init subrouti
                                                            ne
   43 00000018 EBFFFFFE        BL               pin_connect_block_setup_for_uar
t0 
                                                            ;setup the pin conn
                                                            ect block
   44 0000001C EBFFFFFE        BL               setup_pins  ;setup pins require
                                                            d for momentary pus
                                                            h button and seven 
                                                            segment display 
   45 00000020 EB00000B        BL               interrupt_init



ARM Macro Assembler    Page 2 


   46 00000024 EBFFFFFE        BL               clear_display
   47 00000028         
   48 00000028 E59F4190        LDR              r4, =enemies
   49 0000002C EBFFFFFE        BL               output_string
   50 00000030         
   51 00000030 E59F218C        LDR              r2, =draw_board
   52 00000034 E1A0E00F        MOV              lr, pc
   53 00000038 E12FFF12        BX               r2
   54 0000003C         
   55 0000003C E3A09000        MOV              r9, #0
   56 00000040         
   57 00000040 E3A08002        MOV              r8, #2
   58 00000044         
   59 00000044         lab7_loop
   60 00000044         
   61 00000044         ;CMP r7, #5
   62 00000044         ;BGE lab7_end
   63 00000044         
   64 00000044 EAFFFFFE        B                lab7_loop
   65 00000048         
   66 00000048         lab7_end
   67 00000048         
   68 00000048 EBFFFFFE        BL               clear_display
   69 0000004C         
   70 0000004C E8BD4000        LDMFD            sp!,{lr}
   71 00000050         
   72 00000050 E12FFF1E        BX               lr
   73 00000054         
   74 00000054         
   75 00000054         
   76 00000054         interrupt_init
   77 00000054         
   78 00000054 E92D4007        STMFD            SP!, {r0-r2, lr} 
                                                            ; Save registers 
   79 00000058         
   80 00000058         ; Push button setup   
   81 00000058         
   82 00000058 E59F0168        LDR              r0, =0xE002C000
   83 0000005C         
   84 0000005C E5901000        LDR              r1, [r0]
   85 00000060         
   86 00000060 E3811202        ORR              r1, r1, #0x20000000
   87 00000064         
   88 00000064 E3C11201        BIC              r1, r1, #0x10000000
   89 00000068         
   90 00000068 E5801000        STR              r1, [r0]    ; PINSEL0 bits 29:2
                                                            8 = 10
   91 0000006C         
   92 0000006C         
   93 0000006C         ;key board setup
   94 0000006C E59F0158        LDR              r0, =0xE000C004
   95 00000070         
   96 00000070 E5901000        LDR              r1, [r0]
   97 00000074         
   98 00000074 E3811001        ORR              r1, r1, #0x1
   99 00000078         
  100 00000078 E5801000        STR              r1, [r0]
  101 0000007C         
  102 0000007C         



ARM Macro Assembler    Page 3 


  103 0000007C         ; Classify sources as IRQ or FIQ
  104 0000007C         
  105 0000007C E59F014C        LDR              r0, =0xFFFFF000
  106 00000080         
  107 00000080 E590100C        LDR              r1, [r0, #0xC]
  108 00000084         
  109 00000084 E59F2148        LDR              r2, =0x8050
  110 00000088         
  111 00000088 E1811002        ORR              r1, r1, r2  ; External Interrup
                                                            t 1
  112 0000008C         
  113 0000008C E580100C        STR              r1, [r0, #0xC]
  114 00000090         
  115 00000090         
  116 00000090         
  117 00000090         ; Enable Interrupts
  118 00000090         
  119 00000090 E59F0138        LDR              r0, =0xFFFFF000
  120 00000094         
  121 00000094 E5901010        LDR              r1, [r0, #0x10]
  122 00000098         
  123 00000098 E59F2134        LDR              r2, =0x8050
  124 0000009C         
  125 0000009C E1811002        ORR              r1, r1, r2  ; External Interrup
                                                            t 1
  126 000000A0         
  127 000000A0 E5801010        STR              r1, [r0, #0x10]
  128 000000A4         
  129 000000A4         
  130 000000A4         
  131 000000A4         ; External Interrupt 1 setup for edge sensitive
  132 000000A4         
  133 000000A4 E59F012C        LDR              r0, =0xE01FC148
  134 000000A8         
  135 000000A8 E5901000        LDR              r1, [r0]
  136 000000AC         
  137 000000AC E3811002        ORR              r1, r1, #2  ; EINT1 = Edge Sens
                                                            itive
  138 000000B0         
  139 000000B0 E5801000        STR              r1, [r0]
  140 000000B4         
  141 000000B4         ; External Timer 0 modify MR0
  142 000000B4         
  143 000000B4 E59F0120        LDR              r0, =0xE0004018
  144 000000B8         
  145 000000B8 E59F1120        LDR              r1, =110000
  146 000000BC         
  147 000000BC E5801000        STR              r1, [r0]
  148 000000C0         
  149 000000C0         
  150 000000C0         ; External Timer 0 MCR
  151 000000C0         
  152 000000C0 E59F011C        LDR              r0, =0xE0004014
  153 000000C4         
  154 000000C4 E5901000        LDR              r1, [r0]
  155 000000C8         
  156 000000C8         ;ORR r1, r1, #3
  157 000000C8         ;ORR r1, r1, #8
  158 000000C8 E3811003        ORR              r1, r1, #0x3



ARM Macro Assembler    Page 4 


  159 000000CC E3C11020        BIC              r1, r1, #0x20
  160 000000D0         
  161 000000D0 E5801000        STR              r1, [r0]
  162 000000D4         
  163 000000D4         ; External Timer 0 timer control register
  164 000000D4         
  165 000000D4 E59F010C        LDR              r0, =0xE0004004
  166 000000D8         
  167 000000D8 E5901000        LDR              r1, [r0]
  168 000000DC         
  169 000000DC E3811001        ORR              r1, r1, #1
  170 000000E0         
  171 000000E0 E5801000        STR              r1, [r0]
  172 000000E4         
  173 000000E4         ; Enable FIQ's, Disable IRQ's
  174 000000E4         
  175 000000E4 E10F0000        MRS              r0, CPSR
  176 000000E8         
  177 000000E8 E3C00040        BIC              r0, r0, #0x40
  178 000000EC         
  179 000000EC E3800080        ORR              r0, r0, #0x80
  180 000000F0         
  181 000000F0 E121F000        MSR              CPSR_c, r0
  182 000000F4         
  183 000000F4         
  184 000000F4         
  185 000000F4 E8BD4007        LDMFD            SP!, {r0-r2, lr} 
                                                            ; Restore registers
                                                            
  186 000000F8         
  187 000000F8 E12FFF1E        BX               lr          ; Return
  188 000000FC         
  189 000000FC         FIQ_Handler
  190 000000FC         
  191 000000FC E92D401F        STMFD            SP!, {r0, r1, r2, r3, r4, lr} 
                                                            ; Save registers
  192 00000100         
  193 00000100         ; Disable Interrupts
  194 00000100         
  195 00000100 E59F00C8        LDR              r0, =0xFFFFF000
  196 00000104         
  197 00000104 E5901010        LDR              r1, [r0, #0x10]
  198 00000108         
  199 00000108 E3A02010        MOV              r2, #0x10
  200 0000010C         
  201 0000010C E1C11002        BIC              r1, r1, r2  ; External Interrup
                                                            t 1
  202 00000110         
  203 00000110 E5801010        STR              r1, [r0, #0x10]
  204 00000114         
  205 00000114 E59F00D0        LDR              r0, =0xE0004000
  206 00000118 E5901000        LDR              r1, [r0]
  207 0000011C E3510000        CMP              r1, #0
  208 00000120 CA000000        BGT              TIMER0
  209 00000124 EA00000C        B                EINT1
  210 00000128         
  211 00000128         TIMER0
  212 00000128         
  213 00000128 E3811001        ORR              r1, r1, #1



ARM Macro Assembler    Page 5 


  214 0000012C E5801000        STR              r1, [r0]
  215 00000130         
  216 00000130         TIMER0LOOP
  217 00000130         
  218 00000130 E59F208C        LDR              r2, =draw_board
  219 00000134 E1A0E00F        MOV              lr, pc
  220 00000138 E12FFF12        BX               r2
  221 0000013C         
  222 0000013C EA000014        B                FIQ_Exit
  223 00000140         
  224 00000140         R0_RESET
  225 00000140 E92D4000        STMFD            SP!, {lr}
  226 00000144 E3A00000        MOV              r0, #0x0
  227 00000148 E2811001        ADD              r1, #0x1
  228 0000014C EBFFFFFE        BL               new_line
  229 00000150 E8BD4000        LDMFD            SP!, {lr}
  230 00000154 E12FFF1E        BX               lr
  231 00000158         
  232 00000158 EA00000D        B                FIQ_Exit
  233 0000015C         
  234 0000015C         EINT1                                ; Check for EINT1 i
                                                            nterrupt
  235 0000015C         
  236 0000015C         
  237 0000015C E59F008C        LDR              r0, =0xE01FC140
  238 00000160         
  239 00000160 E5901000        LDR              r1, [r0]
  240 00000164         
  241 00000164 E3110002        TST              r1, #2
  242 00000168         
  243 00000168 0A000003        BEQ              FIQ_Keys
  244 0000016C         
  245 0000016C EBFFFFFE        BL               toggle_seven_seg
  246 00000170         
  247 00000170 E3811002        ORR              r1, r1, #2  ; Clear Interrupt
  248 00000174         
  249 00000174 E5801000        STR              r1, [r0]
  250 00000178         
  251 00000178 EA000005        B                FIQ_Exit
  252 0000017C         
  253 0000017C         FIQ_Keys
  254 0000017C         
  255 0000017C E59F0070        LDR              r0, =0xE000C008
  256 00000180         
  257 00000180 E5901000        LDR              r1, [r0]
  258 00000184         
  259 00000184 E2012001        AND              r2, r1, #1
  260 00000188         
  261 00000188 E3520000        CMP              r2, #0
  262 0000018C         
  263 0000018C 1A000000        BNE              FIQ_Exit
  264 00000190         
  265 00000190 EBFFFFFE        BL               read_character
  266 00000194         
  267 00000194         quit_skip
  268 00000194         
  269 00000194         FIQ_Exit
  270 00000194         
  271 00000194         



ARM Macro Assembler    Page 6 


  272 00000194         ; Enable Interrupts
  273 00000194         
  274 00000194 E59F0034        LDR              r0, =0xFFFFF000
  275 00000198         
  276 00000198 E5901010        LDR              r1, [r0, #0x10]
  277 0000019C         
  278 0000019C E59F2030        LDR              r2, =0x8050
  279 000001A0         
  280 000001A0 E1811002        ORR              r1, r1, r2  ; External Interrup
                                                            t 1
  281 000001A4         
  282 000001A4 E5801010        STR              r1, [r0, #0x10]
  283 000001A8         
  284 000001A8         
  285 000001A8         
  286 000001A8 E59F003C        LDR              r0, =0xE0004000
  287 000001AC E5901000        LDR              r1, [r0]
  288 000001B0         
  289 000001B0 E3C11001        BIC              r1, r1, #1
  290 000001B4 E5801000        STR              r1, [r0]
  291 000001B8         
  292 000001B8 E8BD401F        LDMFD            SP!, {r0, r1, r2, r3, r4, lr}
  293 000001BC         
  294 000001BC E25EF004        SUBS             pc, lr, #4
  295 000001C0         
  296 000001C0         
  297 000001C0         
  298 000001C0                 END
              00000000 
              00000000 
              E002C000 
              E000C004 
              FFFFF000 
              00008050 
              E01FC148 
              E0004018 
              0001ADB0 
              E0004014 
              E0004004 
              E0004000 
              E01FC140 
              E000C008 
Command Line: --debug --xref --diag_suppress=9931 --apcs=interwork --depend=.\o
bjects\lab7.d -o.\objects\lab7.o -ID:\Keil\ARM\ARM\RV31\INC -ID:\Keil\ARM\ARM\C
MSIS\Include -ID:\Keil\ARM\ARM\INC\Philips --predefine="__EVAL SETA 1" --predef
ine="__UVISION_VERSION SETA 524" --list=.\listings\lab7.lst lab7.s



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

EINT1 0000015C

Symbol: EINT1
   Definitions
      At line 234 in file lab7.s
   Uses
      At line 209 in file lab7.s
Comment: EINT1 used once
FIQ_Exit 00000194

Symbol: FIQ_Exit
   Definitions
      At line 269 in file lab7.s
   Uses
      At line 222 in file lab7.s
      At line 232 in file lab7.s
      At line 251 in file lab7.s
      At line 263 in file lab7.s

FIQ_Handler 000000FC

Symbol: FIQ_Handler
   Definitions
      At line 189 in file lab7.s
   Uses
      At line 6 in file lab7.s
Comment: FIQ_Handler used once
FIQ_Keys 0000017C

Symbol: FIQ_Keys
   Definitions
      At line 253 in file lab7.s
   Uses
      At line 243 in file lab7.s
Comment: FIQ_Keys used once
R0_RESET 00000140

Symbol: R0_RESET
   Definitions
      At line 224 in file lab7.s
   Uses
      None
Comment: R0_RESET unused
TIMER0 00000128

Symbol: TIMER0
   Definitions
      At line 211 in file lab7.s
   Uses
      At line 208 in file lab7.s
Comment: TIMER0 used once
TIMER0LOOP 00000130

Symbol: TIMER0LOOP
   Definitions
      At line 216 in file lab7.s
   Uses
      None
Comment: TIMER0LOOP unused



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

enemies 00000000

Symbol: enemies
   Definitions
      At line 33 in file lab7.s
   Uses
      At line 48 in file lab7.s
Comment: enemies used once
interrupt_init 00000054

Symbol: interrupt_init
   Definitions
      At line 76 in file lab7.s
   Uses
      At line 45 in file lab7.s
Comment: interrupt_init used once
interrupts 00000000

Symbol: interrupts
   Definitions
      At line 2 in file lab7.s
   Uses
      None
Comment: interrupts unused
lab7 00000010

Symbol: lab7
   Definitions
      At line 38 in file lab7.s
   Uses
      At line 4 in file lab7.s
Comment: lab7 used once
lab7_end 00000048

Symbol: lab7_end
   Definitions
      At line 66 in file lab7.s
   Uses
      None
Comment: lab7_end unused
lab7_loop 00000044

Symbol: lab7_loop
   Definitions
      At line 59 in file lab7.s
   Uses
      At line 64 in file lab7.s
Comment: lab7_loop used once
quit_skip 00000194

Symbol: quit_skip
   Definitions
      At line 267 in file lab7.s
   Uses
      None
Comment: quit_skip unused
shields_alive 00000005

Symbol: shields_alive



ARM Macro Assembler    Page 3 Alphabetic symbol ordering
Relocatable symbols

   Definitions
      At line 34 in file lab7.s
   Uses
      None
Comment: shields_alive unused
shields_type 0000000A

Symbol: shields_type
   Definitions
      At line 35 in file lab7.s
   Uses
      None
Comment: shields_type unused
16 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
External symbols

change_display 00000000

Symbol: change_display
   Definitions
      At line 12 in file lab7.s
   Uses
      None
Comment: change_display unused
change_display_digit 00000000

Symbol: change_display_digit
   Definitions
      At line 20 in file lab7.s
   Uses
      None
Comment: change_display_digit unused
clear_display 00000000

Symbol: clear_display
   Definitions
      At line 13 in file lab7.s
   Uses
      At line 46 in file lab7.s
      At line 68 in file lab7.s

clear_input 00000000

Symbol: clear_input
   Definitions
      At line 27 in file lab7.s
   Uses
      None
Comment: clear_input unused
draw_board 00000000

Symbol: draw_board
   Definitions
      At line 30 in file lab7.s
   Uses
      At line 51 in file lab7.s
      At line 218 in file lab7.s

from_ascii 00000000

Symbol: from_ascii
   Definitions
      At line 23 in file lab7.s
   Uses
      None
Comment: from_ascii unused
get_char_at 00000000

Symbol: get_char_at
   Definitions
      At line 29 in file lab7.s
   Uses
      None
Comment: get_char_at unused
get_digit 00000000



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
External symbols


Symbol: get_digit
   Definitions
      At line 21 in file lab7.s
   Uses
      None
Comment: get_digit unused
get_input 00000000

Symbol: get_input
   Definitions
      At line 26 in file lab7.s
   Uses
      None
Comment: get_input unused
is_enemy_alive 00000000

Symbol: is_enemy_alive
   Definitions
      At line 31 in file lab7.s
   Uses
      None
Comment: is_enemy_alive unused
new_line 00000000

Symbol: new_line
   Definitions
      At line 18 in file lab7.s
   Uses
      At line 228 in file lab7.s
Comment: new_line used once
output_character 00000000

Symbol: output_character
   Definitions
      At line 16 in file lab7.s
   Uses
      None
Comment: output_character unused
output_string 00000000

Symbol: output_string
   Definitions
      At line 17 in file lab7.s
   Uses
      At line 49 in file lab7.s
Comment: output_string used once
pin_connect_block_setup_for_uart0 00000000

Symbol: pin_connect_block_setup_for_uart0
   Definitions
      At line 9 in file lab7.s
   Uses
      At line 43 in file lab7.s
Comment: pin_connect_block_setup_for_uart0 used once
read_character 00000000

Symbol: read_character
   Definitions



ARM Macro Assembler    Page 3 Alphabetic symbol ordering
External symbols

      At line 15 in file lab7.s
   Uses
      At line 265 in file lab7.s
Comment: read_character used once
setup_pins 00000000

Symbol: setup_pins
   Definitions
      At line 10 in file lab7.s
   Uses
      At line 44 in file lab7.s
Comment: setup_pins used once
store_input 00000000

Symbol: store_input
   Definitions
      At line 25 in file lab7.s
   Uses
      None
Comment: store_input unused
toggle_seven_seg 00000000

Symbol: toggle_seven_seg
   Definitions
      At line 14 in file lab7.s
   Uses
      At line 245 in file lab7.s
Comment: toggle_seven_seg used once
uart_init 00000000

Symbol: uart_init
   Definitions
      At line 8 in file lab7.s
   Uses
      At line 42 in file lab7.s
Comment: uart_init used once
validate_input 00000000

Symbol: validate_input
   Definitions
      At line 11 in file lab7.s
   Uses
      None
Comment: validate_input unused
20 symbols
370 symbols in table
